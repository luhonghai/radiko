William Seemann <wseemann@gmail.com>

[PATCH 2/3] Add a configure parameter for adding a prefix to the soname. Add an option for overriding the optimization settings chosen by configure
---

--- a/configure	2015-01-09 22:21:15.000000000 -0600
+++ b/configure	2015-01-17 15:09:21.000000000 -0600
@@ -311,6 +311,7 @@
   --extra-ldexeflags=ELDFLAGS add ELDFLAGS to LDEXEFLAGS [$LDEXEFLAGS]
   --extra-libs=ELIBS       add ELIBS [$ELIBS]
   --extra-version=STRING   version string suffix []
+  --optimization-flags=FLAGS use FLAGS instead of the optimization flags chosen by other options []
   --optflags=OPTFLAGS      override optimization-related compiler flags
   --build-suffix=SUFFIX    library name suffix []
   --enable-pic             build position-independent code
@@ -1941,6 +1942,7 @@
     logfile
     malloc_prefix
     nm
+    optimization_flags
     optflags
     pkg_config
     pkg_config_flags
@@ -2734,7 +2736,7 @@
 enable xlib
 
 # build settings
-SHFLAGS='-shared -Wl,-soname,$$(@F)'
+SHFLAGS='-shared -Wl,-soname,$$(SONAME_PREFIX)$$(@F)'
 LIBPREF="lib"
 LIBSUF=".a"
 FULLNAME='$(NAME)$(BUILDSUF)'
@@ -5178,6 +5180,12 @@
 EOF
 fi
 
+if test "$optimization_flags" != ""; then
+    size_cflags="$optimization_flags"
+    speed_cflags="$optimization_flags"
+    noopt_cflags="$optimization_flags"
+fi
+
 if [ -z "$optflags" ]; then
     if enabled small; then
         optflags=$cflags_size
